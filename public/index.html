<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Liberty Linen PAR Calculator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background: linear-gradient(to right, #f0f8ff, #e6f2ff); margin: 0; padding: 0; color: #333; }
    .container { max-width: 1000px; margin: 40px auto; background: white; border-radius: 12px; box-shadow: 0 8px 24px rgba(0,82,204,0.1); padding: 40px; }
    h1 { text-align: center; color: #002147; margin-bottom: 40px; font-size: 2.2rem; }
    .section { margin-bottom: 48px; border-left: 6px solid #0052cc; padding-left: 20px; background: #f9fbff; border-radius: 6px; padding: 20px; }
    .section h2 { color: #0052cc; font-size: 1.4rem; margin-top: 0; }
    .field-group { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 20px; margin-top: 20px; }
    .field { display: flex; flex-direction: column; }
    .field label { font-weight: 600; margin-bottom: 6px; }
    .field input { padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; }
    .field input[disabled] { background: #eee; }
    .radio-toggle { display: flex; gap: 20px; margin-top: 10px; }
    .radio-toggle label { font-weight: 500; }
    button { background: #003366; color: #fff; border: none; border-radius: 6px; padding: 14px 20px; font-size: 1.1rem; margin-top: 30px; cursor: pointer; }
    button:hover { background: #0052cc; }
    .results { margin-top: 40px; background: #e9f1ff; padding: 20px; border-radius: 6px; }
    .results h2 { color: #003366; }
    table.results-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    table.results-table th, table.results-table td { padding: 10px; text-align: left; }
    table.results-table th { border-bottom: 2px solid #003366; color: #003366; }
    table.results-table td { border-bottom: 1px solid #ccc; }
    .export-buttons { display: flex; flex-direction: column; align-items: center; gap: 10px; margin-top: 24px; }
    @media (min-width: 600px) { .export-buttons { flex-direction: row; justify-content: center; } }
    .branding { text-align: center; margin-top: 40px; font-weight: 500; color: #888; font-size: 0.9rem; }
  </style>
</head>
<body>
  <div class="container">
    <h1>Liberty Linen PAR Calculator</h1>

    <!-- General Info -->
    <div class="section">
      <h2>General Property Info</h2>
      <div class="field-group">
        <div class="field"><label for="numRooms">Guest Rooms</label><input type="number" id="numRooms" value="1" /></div>
        <div class="field"><label for="occupancy">Occupancy (%)</label><input type="number" id="occupancy" value="100" /></div>
        <div class="field"><label for="parLevel">PAR Level</label><input type="number" id="parLevel" value="3" /></div>
      </div>
    </div>

    <!-- Bedding -->
    <div class="section">
      <h2>Bedding Inventory</h2>
      <div class="radio-toggle">
        <label><input type="radio" name="sheetSetup" value="twoFlats" checked onchange="toggleFitted()"> Two Flat Sheets</label>
        <label><input type="radio" name="sheetSetup" value="flatFitted" onchange="toggleFitted()"> Flat + Fitted</label>
      </div>
      <div class="field-group">
        <div class="field"><label>King Beds</label><input type="number" id="bedKing" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label>Cal King Beds</label><input type="number" id="bedCalKing" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label>Queen Beds</label><input type="number" id="bedQueen" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label>Full Beds</label><input type="number" id="bedFull" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label>Twin Beds</label><input type="number" id="bedTwin" value="0" onchange="syncPillowcases()" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label>Fitted King</label><input type="number" id="fittedKing" value="0" /></div>
        <div class="field"><label>Fitted Cal King</label><input type="number" id="fittedCalKing" value="0" /></div>
        <div class="field"><label>Fitted Queen</label><input type="number" id="fittedQueen" value="0" /></div>
        <div class="field"><label>Fitted Full</label><input type="number" id="fittedFull" value="0" /></div>
        <div class="field"><label>Fitted Twin</label><input type="number" id="fittedTwin" value="0" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label>King Pillowcases</label><input type="number" id="pillowKing" value="0" /></div>
        <div class="field"><label>Queen Pillowcases</label><input type="number" id="pillowQueen" value="0" /></div>
        <div class="field"><label>Standard Pillowcases</label><input type="number" id="pillowStd" value="0" /></div>
      </div>
    </div>

    <!-- Towels -->
    <div class="section">
      <h2>Terry Inventory</h2>
      <div class="field-group">
        <div class="field"><label>Bathrooms per Room</label><input type="number" id="numBathrooms" value="1" /></div>
        <div class="field"><label>Bath Towels</label><input type="number" id="towelBath" value="0" /></div>
        <div class="field"><label>Hand Towels</label><input type="number" id="towelHand" value="0" /></div>
        <div class="field"><label>Washcloths</label><input type="number" id="towelWash" value="0" /></div>
        <div class="field"><label>Bath Mats</label><input type="number" id="towelMat" value="0" /></div>
      </div>
    </div>

    <button onclick="calculateResults()">Calculate Requirements</button>

    <div class="results" id="results" style="display:none;">
      <h2>Estimated Linen Requirements</h2>
      <div id="summaryInfo"></div>
      <table class="results-table" id="resultsTable"></table>
      <div class="export-buttons">
        <button onclick="exportPDF()">Export to PDF</button>
        <button onclick="emailResults()">Email Results</button>
      </div>
    </div>

    <div class="branding">Powered by Liberty Linen · Orange Beach, AL · <a href='https://www.libertylinen.com'>libertylinen.com</a></div>
  </div>

  <script>
    function toggleFitted() {
      const isFlatFitted = document.querySelector('input[name="sheetSetup"]:checked').value === 'flatFitted';
      document.querySelectorAll('[id^="fitted"]').forEach(el => el.disabled = !isFlatFitted);
    }

    function syncPillowcases() {
      const king = (+bedKing.value || 0) + (+bedCalKing.value || 0);
      const other = (+bedQueen.value || 0) + (+bedFull.value || 0) + (+bedTwin.value || 0);
      pillowKing.value = king * 2;
      pillowStd.value = other * 2;
    }

 <script>
  function toggleFitted() {
    const isFlatFitted = document.querySelector('input[name="sheetSetup"]:checked').value === 'flatFitted';
    document.querySelectorAll('[id^="fitted"]').forEach(el => el.disabled = !isFlatFitted);
  }

  function syncPillowcases() {
    const king = (+bedKing.value || 0) + (+bedCalKing.value || 0);
    const other = (+bedQueen.value || 0) + (+bedFull.value || 0) + (+bedTwin.value || 0);
    pillowKing.value = king * 2;
    pillowStd.value = other * 2;
  }

  function calculateResults() {
    const par = +parLevel.value || 1;
    const rooms = +numRooms.value || 1;
    const occ = +occupancy.value || 100;
    const results = { Bedding: {}, Terry: {} };
    const isFlatFitted = document.querySelector('input[name="sheetSetup"]:checked').value === 'flatFitted';

    ['King','CalKing','Queen','Full','Twin'].forEach(size => {
      const beds = +document.getElementById('bed'+size).value || 0;
      if (beds) {
        if (isFlatFitted) {
          const fitted = +document.getElementById('fitted'+size).value || 0;
          results.Bedding[`Flat Sheets (${size})`] = beds * par;
          results.Bedding[`Fitted Sheets (${size})`] = fitted * par;
        } else {
          results.Bedding[`Flat Sheets (${size})`] = beds * 2 * par;
        }
      }
    });

    results.Bedding['King Pillowcases'] = +pillowKing.value * par;
    results.Bedding['Queen Pillowcases'] = +pillowQueen.value * par;
    results.Bedding['Standard Pillowcases'] = +pillowStd.value * par;

    const baths = +numBathrooms.value || 1;
    results.Terry['Bath Towels'] = +towelBath.value * baths * par;
    results.Terry['Hand Towels'] = +towelHand.value * baths * par;
    results.Terry['Washcloths'] = +towelWash.value * baths * par;
    results.Terry['Bath Mats'] = +towelMat.value * baths * par;

    const table = document.getElementById('resultsTable');
    const resultsDiv = document.getElementById('results');
    const summaryInfo = document.getElementById('summaryInfo');

    table.innerHTML = '';
    Object.entries(results).forEach(([section, items]) => {
      const headerRow = document.createElement('tr');
      headerRow.innerHTML = `<th colspan='2'>${section}</th>`;
      table.appendChild(headerRow);
      Object.entries(items).forEach(([item, qty]) => {
        const row = document.createElement('tr');
        row.innerHTML = `<td>${item}</td><td>${qty} units</td>`;
        table.appendChild(row);
      });
    });

    const date = new Date().toLocaleDateString();
    summaryInfo.innerHTML = `<p><strong>Guest Rooms:</strong> ${rooms} | <strong>Occupancy:</strong> ${occ}% | <strong>PAR:</strong> ${par}</p><p><em>Generated on ${date}</em></p>`;
    resultsDiv.style.display = 'block';
  }

  function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    let y = 20;
    doc.setFontSize(16);
    doc.text('Liberty Linen - Estimated Linen Requirements', 20, y);
    y += 10;
    doc.setFontSize(11);
    document.querySelectorAll('#summaryInfo p').forEach(p => { doc.text(p.textContent, 20, y); y += 8; });
    y += 5;
    document.querySelectorAll('#resultsTable tr').forEach(tr => {
      const cells = tr.querySelectorAll('th, td');
      if (cells.length === 1) { doc.setFont(undefined, 'bold'); doc.text(cells[0].textContent, 20, y); doc.setFont(undefined, 'normal'); }
      else { doc.text(cells[0].textContent, 25, y); doc.text(cells[1].textContent, 120, y); }
      y += 8;
    });
    doc.setFontSize(10);
    doc.text('*These values are estimates based on your inputs.', 20, y + 10);
    doc.save('Liberty_Linen_PAR_Results.pdf');
  }

  function emailResults() {
    const summary = document.getElementById('summaryInfo').innerText;
    const rows = Array.from(document.querySelectorAll('#resultsTable tr')).map(r => r.innerText).join('%0D%0A');
    window.location.href = `mailto:?subject=Liberty Linen PAR Results&body=${encodeURIComponent(summary + '\n' + rows)}`;
  }

  window.onload = () => { toggleFitted(); syncPillowcases(); };
</script>
</body>
</html>
