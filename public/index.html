<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Liberty Linen PAR Calculator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #f0f8ff, #e6f2ff);
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 1000px;
      margin: 40px auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0, 82, 204, 0.1);
      padding: 40px;
    }
    h1 {
      text-align: center;
      color: #002147;
      margin-bottom: 40px;
      font-size: 2.2rem;
    }
    .section {
      margin-bottom: 48px;
      border-left: 6px solid #0052cc;
      padding-left: 20px;
      background: #f9fbff;
      border-radius: 6px;
      padding-top: 20px;
      padding-bottom: 20px;
    }
    .section h2 {
      color: #0052cc;
      margin-top: 0;
      font-size: 1.4rem;
    }
    .field-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .field {
      display: flex;
      flex-direction: column;
    }
    .field label {
      font-weight: 600;
      margin-bottom: 6px;
    }
    .field input,
    .field select {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    .field input[disabled] {
      background-color: #f0f0f0;
    }
    .radio-toggle {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }
    .radio-toggle label {
      font-weight: 500;
    }
    button {
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 14px 20px;
      font-size: 1.1rem;
      margin-top: 30px;
      cursor: pointer;
    }
    button:hover {
      background-color: #0052cc;
    }
    .results {
      margin-top: 40px;
      background-color: #e9f1ff;
      padding: 20px;
      border-radius: 6px;
    }
    .results h2 {
      margin-top: 0;
      color: #003366;
    }
    .results ul {
      list-style: none;
      padding: 0;
    }
    .results li {
      padding: 6px 0;
    }
    .branding {
      text-align: center;
      margin-top: 40px;
      font-weight: 500;
      color: #888;
      font-size: 0.9rem;
    }
    .export-buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-top: 24px;
    }
    @media (min-width: 600px) {
      .export-buttons {
        flex-direction: row;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Liberty Linen PAR Calculator</h1>

    <!-- General Info -->
    <div class="section">
      <h2>General Property Info</h2>
      <div class="field-group">
        <div class="field">
          <label for="numRooms">Number of Guest Rooms</label>
          <input type="number" id="numRooms" min="1" value="1" />
        </div>
        <div class="field">
          <label for="occupancy">Occupancy Rate (%)</label>
          <input type="number" id="occupancy" min="0" max="100" value="100" />
        </div>
        <div class="field">
          <label for="parLevel">Desired PAR Level</label>
          <input type="number" id="parLevel" min="1" value="3" />
        </div>
      </div>
    </div>

    <!-- Bedding Section -->
    <div class="section">
      <h2>Bedding Inventory</h2>
      <div class="radio-toggle">
        <label><input type="radio" name="sheetSetup" value="twoFlats" checked onchange="toggleFitted()"> Two Flat Sheets</label>
        <label><input type="radio" name="sheetSetup" value="flatFitted" onchange="toggleFitted()"> Flat + Fitted</label>
      </div>
      <div class="field-group">
        <div class="field"><label for="bedKing">King Beds</label><input type="number" id="bedKing" min="0" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label for="bedCalKing">Cal King Beds</label><input type="number" id="bedCalKing" min="0" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label for="bedQueen">Queen Beds</label><input type="number" id="bedQueen" min="0" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label for="bedFull">Full Beds</label><input type="number" id="bedFull" min="0" value="0" onchange="syncPillowcases()" /></div>
        <div class="field"><label for="bedTwin">Twin Beds</label><input type="number" id="bedTwin" min="0" value="0" onchange="syncPillowcases()" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label for="fittedKing">Fitted King</label><input type="number" id="fittedKing" value="0" /></div>
        <div class="field"><label for="fittedCalKing">Fitted Cal King</label><input type="number" id="fittedCalKing" value="0" /></div>
        <div class="field"><label for="fittedQueen">Fitted Queen</label><input type="number" id="fittedQueen" value="0" /></div>
        <div class="field"><label for="fittedFull">Fitted Full</label><input type="number" id="fittedFull" value="0" /></div>
        <div class="field"><label for="fittedTwin">Fitted Twin</label><input type="number" id="fittedTwin" value="0" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label for="pillowKing">King Pillowcases</label><input type="number" id="pillowKing" value="0" /></div>
        <div class="field"><label for="pillowQueen">Queen Pillowcases</label><input type="number" id="pillowQueen" value="0" /></div>
        <div class="field"><label for="pillowStd">Standard Pillowcases</label><input type="number" id="pillowStd" value="0" /></div>
      </div>
    </div>

    <!-- Towels -->
    <div class="section">
      <h2>Terry Inventory</h2>
      <div class="field-group">
        <div class="field"><label for="numBathrooms">Bathrooms per Room</label><input type="number" id="numBathrooms" min="1" value="1" /></div>
        <div class="field"><label for="towelBath">Bath Towels</label><input type="number" id="towelBath" value="0" /></div>
        <div class="field"><label for="towelHand">Hand Towels</label><input type="number" id="towelHand" value="0" /></div>
        <div class="field"><label for="towelWash">Washcloths</label><input type="number" id="towelWash" value="0" /></div>
        <div class="field"><label for="towelMat">Bath Mats</label><input type="number" id="towelMat" value="0" /></div>
      </div>
    </div>

    <button onclick="calculateResults()">Calculate Requirements</button>

    <div class="results" id="results" style="display:none;">
      <h2>Estimated Linen Requirements</h2>
      <ul id="resultsList"></ul>
      <div class="export-buttons">
        <button onclick="exportPDF()">Export to PDF</button>
        <button onclick="emailResults()">Email Results</button>
      </div>
    </div>

    <div class="branding">
      Powered by Liberty Linen · Orange Beach, AL · <a href="https://www.libertylinen.com">libertylinen.com</a>
    </div>
  </div>

  <script>
    function toggleFitted() {
      const isFlatFitted = document.querySelector('input[name=\"sheetSetup\"]:checked').value === 'flatFitted';
      document.querySelectorAll('[id^=\"fitted\"]').forEach(el => {
        el.disabled = !isFlatFitted;
      });
    }

    function syncPillowcases() {
      const king = (+document.getElementById('bedKing').value || 0) + (+document.getElementById('bedCalKing').value || 0);
      const other = (+document.getElementById('bedQueen').value || 0) + (+document.getElementById('bedFull').value || 0) + (+document.getElementById('bedTwin').value || 0);
      document.getElementById('pillowKing').value = king * 2;
      document.getElementById('pillowStd').value = other * 2;
    }

    function calculateResults() {
      const par = +document.getElementById('parLevel').value || 1;
      const results = {};
      const isFlatFitted = document.querySelector('input[name=\"sheetSetup\"]:checked').value === 'flatFitted';

      // Towels
      const baths = +document.getElementById('numBathrooms').value || 1;
      ['Bath','Hand','Wash','Mat'].forEach(type => {
        const val = +document.getElementById(`towel${type}`).value || 0;
        if (val) results[`${type} Towels`] = val * baths * par;
      });

      // Sheets
      ['King','CalKing','Queen','Full','Twin'].forEach(size => {
        const beds = +document.getElementById(`bed${size}`).value || 0;
        if (beds) {
          if (isFlatFitted) {
            const fitted = +document.getElementById(`fitted${size}`).value || 0;
            results[`Flat Sheets (${size})`] = beds * par;
            results[`Fitted Sheets (${size})`] = fitted * par;
          } else {
            results[`Flat Sheets (${size})`] = beds * 2 * par;
          }
        }
      });

      // Pillowcases
      ['King','Queen','Std'].forEach(type => {
        const val = +document.getElementById(`pillow${type}`).value || 0;
        if (val) results[`${type} Pillowcases`] = val * par;
      });

      const list = document.getElementById('resultsList');
      list.innerHTML = '';
      Object.entries(results).forEach(([k,v]) => {
        const li = document.createElement('li');
        li.textContent = `${k}: ${v} units`;
        list.appendChild(li);
      });
      document.getElementById('results').style.display = 'block';
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text('Liberty Linen PAR Results', 20, 20);
      let y = 30;
      document.querySelectorAll('#resultsList li').forEach(li => {
        doc.text(li.textContent, 20, y);
        y += 10;
      });
      doc.save('liberty_par_results.pdf');
    }

    function emailResults() {
      const lines = Array.from(document.querySelectorAll('#resultsList li')).map(li => li.textContent).join('%0D%0A');
      window.location.href = `mailto:?subject=Liberty Linen Results&body=${lines}`;
    }

    window.onload = () => {
      toggleFitted();
      syncPillowcases();
    };
  </script>
</body>
</html>
