<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Liberty Linen PAR Calculator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(to right, #3A6EA5, #1E2A38);
      margin: 0;
      padding: 0;
      color: #333;
    }
    .container {
      max-width: 1000px;
      margin: 40px auto;
      background: white;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.1);
      padding: 40px;
    }
    .logo-header {
      text-align: center;
      margin-bottom: 30px;
    }
    .logo-header img {
      max-width: 260px;
      height: auto;
    }
    h1 {
      text-align: center;
      color: #1E2A38;
      margin-bottom: 30px;
      font-size: 2rem;
    }
    .section {
      margin-bottom: 48px;
      border-left: 6px solid #3A6EA5;
      padding-left: 20px;
      background: #f9fbff;
      border-radius: 6px;
      padding: 20px;
    }
    .section h2 {
      color: #3A6EA5;
      font-size: 1.4rem;
      margin-top: 0;
    }
    .field-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .field { display: flex; flex-direction: column; }
    .field label { font-weight: 600; margin-bottom: 6px; }
    .field input {
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }
    .field input[disabled] { background: #eee; }
    .radio-toggle { display: flex; gap: 20px; margin-top: 10px; }
    .radio-toggle label { font-weight: 500; }
    button {
      background: #1E2A38;
      color: #fff;
      border: none;
      border-radius: 6px;
      padding: 14px 20px;
      font-size: 1.1rem;
      margin-top: 30px;
      cursor: pointer;
    }
    button:hover { background: #3A6EA5; }
    .results {
      margin-top: 40px;
      background: #e9f1ff;
      padding: 20px;
      border-radius: 6px;
    }
    .results h2 { color: #1E2A38; }
    table.results-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    table.results-table th, table.results-table td {
      padding: 10px;
      text-align: left;
    }
    table.results-table th {
      border-bottom: 2px solid #1E2A38;
      color: #1E2A38;
    }
    table.results-table td { border-bottom: 1px solid #ccc; }
    .export-buttons {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      margin-top: 24px;
    }
    @media (min-width: 600px) {
      .export-buttons { flex-direction: row; justify-content: center; }
    }
    .branding {
      text-align: center;
      margin-top: 40px;
      font-weight: 500;
      color: #888;
      font-size: 0.9rem;
    }
    a { color: #3A6EA5; text-decoration: none; }
  </style>
</head>
<body>
  <div class="container">
    <div class="logo-header">
      <img src="https://raw.githubusercontent.com/campbell3cw/Hospitality-Par-Calculater/main/public/Liberty%20Logo.jpg" alt="Liberty Linen Logo">
    </div>
    <h1>Hospitality PAR Calculator</h1>

    <div class="section">
      <h2>General Property Info</h2>
      <div class="field-group">
        <div class="field"><label for="numRooms">Guest Rooms</label><input type="number" id="numRooms" value="1" /></div>
        <div class="field"><label for="occupancy">Occupancy (%)</label><input type="number" id="occupancy" value="100" /></div>
        <div class="field"><label for="parLevel">PAR Level</label><input type="number" id="parLevel" value="3" /></div>
      </div>
    </div>

    <div class="section">
      <h2>Bedding Inventory</h2>
      <div class="radio-toggle">
        <label><input type="radio" name="sheetSetup" value="twoFlats" checked> Two Flat Sheets</label>
        <label><input type="radio" name="sheetSetup" value="flatFitted"> Flat + Fitted</label>
      </div>
      <div class="field-group">
        <div class="field"><label>King Beds</label><input type="number" id="bedKing" value="0" /></div>
        <div class="field"><label>Cal King Beds</label><input type="number" id="bedCalKing" value="0" /></div>
        <div class="field"><label>Queen Beds</label><input type="number" id="bedQueen" value="0" /></div>
        <div class="field"><label>Full Beds</label><input type="number" id="bedFull" value="0" /></div>
        <div class="field"><label>Twin Beds</label><input type="number" id="bedTwin" value="0" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label>Fitted King</label><input type="number" id="fittedKing" value="0" /></div>
        <div class="field"><label>Fitted Cal King</label><input type="number" id="fittedCalKing" value="0" /></div>
        <div class="field"><label>Fitted Queen</label><input type="number" id="fittedQueen" value="0" /></div>
        <div class="field"><label>Fitted Full</label><input type="number" id="fittedFull" value="0" /></div>
        <div class="field"><label>Fitted Twin</label><input type="number" id="fittedTwin" value="0" /></div>
      </div>
      <div class="field-group">
        <div class="field"><label>King Pillowcases</label><input type="number" id="pillowKing" value="0" /></div>
        <div class="field"><label>Queen Pillowcases</label><input type="number" id="pillowQueen" value="0" /></div>
        <div class="field"><label>Standard Pillowcases</label><input type="number" id="pillowStd" value="0" /></div>
      </div>
    </div>

    <div class="section">
      <h2>Terry Inventory</h2>
      <div class="field-group">
        <div class="field"><label>Bathrooms per Room</label><input type="number" id="numBathrooms" value="1" /></div>
        <div class="field"><label>Bath Towels</label><input type="number" id="towelBath" value="0" /></div>
        <div class="field"><label>Hand Towels</label><input type="number" id="towelHand" value="0" /></div>
        <div class="field"><label>Washcloths</label><input type="number" id="towelWash" value="0" /></div>
        <div class="field"><label>Bath Mats</label><input type="number" id="towelMat" value="0" /></div>
      </div>
    </div>

    <button onclick="calculateResults()">Calculate Requirements</button>

    <div class="results" id="results" style="display:none;">
      <h2>Estimated Linen Requirements</h2>
      <div id="summaryInfo"></div>
      <table class="results-table" id="resultsTable"></table>
      <div class="export-buttons">
        <button onclick="exportPDF()">Export to PDF</button>
        <button onclick="emailResults()">Email Results</button>
      </div>
    </div>

    <div class="branding">Powered by Liberty Linen · Orange Beach, AL · <a href='https://www.libertylinen.com'>libertylinen.com</a></div>
  </div>

  <script>
    function toggleFitted() {
      const selected = document.querySelector('input[name="sheetSetup"]:checked');
      if (!selected) return;
      const isFlatFitted = selected.value === 'flatFitted';
      document.querySelectorAll('[id^="fitted"]').forEach(el => {
        el.disabled = !isFlatFitted;
        if (!isFlatFitted) el.value = 0;
      });
    }

    function syncPillowcases() {
      const bedKing = document.getElementById('bedKing');
      const bedCalKing = document.getElementById('bedCalKing');
      const bedQueen = document.getElementById('bedQueen');
      const bedFull = document.getElementById('bedFull');
      const bedTwin = document.getElementById('bedTwin');
      const pillowKing = document.getElementById('pillowKing');
      const pillowStd = document.getElementById('pillowStd');

      if (!bedKing || !bedCalKing || !pillowKing || !pillowStd) return;

      const king = (+bedKing.value || 0) + (+bedCalKing.value || 0);
      const other = (+bedQueen.value || 0) + (+bedFull.value || 0) + (+bedTwin.value || 0);
      pillowKing.value = king * 2;
      pillowStd.value = other * 2;
    }

    function calculateResults() {
      const par = +document.getElementById('parLevel').value || 1;
      const rooms = +document.getElementById('numRooms').value || 1;
      const occ = +document.getElementById('occupancy').value || 100;
      const results = { Bedding: {}, Terry: {} };
      const setupRadio = document.querySelector('input[name="sheetSetup"]:checked');
      const isFlatFitted = setupRadio && setupRadio.value === 'flatFitted';

      const table = document.getElementById('resultsTable');
      const resultsDiv = document.getElementById('results');
      const summaryInfo = document.getElementById('summaryInfo');

      ['King','CalKing','Queen','Full','Twin'].forEach(size => {
        const beds = +document.getElementById('bed' + size).value || 0;
        if (beds > 0) {
          if (isFlatFitted) {
            results.Bedding[`Flat Sheets (${size})`] = beds * par;
            results.Bedding[`Fitted Sheets (${size})`] = beds * par;
          } else {
            results.Bedding[`Flat Sheets (${size})`] = beds * 2 * par;
          }
        }
      });

      results.Bedding['King Pillowcases'] = (+document.getElementById('pillowKing').value || 0) * par;
      results.Bedding['Queen Pillowcases'] = (+document.getElementById('pillowQueen').value || 0) * par;
      results.Bedding['Standard Pillowcases'] = (+document.getElementById('pillowStd').value || 0) * par;

      const baths = +document.getElementById('numBathrooms').value || 1;
      results.Terry['Bath Towels'] = (+document.getElementById('towelBath').value || 0) * baths * par;
      results.Terry['Hand Towels'] = (+document.getElementById('towelHand').value || 0) * baths * par;
      results.Terry['Washcloths'] = (+document.getElementById('towelWash').value || 0) * baths * par;
      results.Terry['Bath Mats'] = (+document.getElementById('towelMat').value || 0) * baths * par;

      table.innerHTML = '';
      Object.entries(results).forEach(([section, items]) => {
        const headerRow = document.createElement('tr');
        headerRow.innerHTML = `<th colspan='2'>${section}</th>`;
        table.appendChild(headerRow);
        Object.entries(items).forEach(([item, qty]) => {
          const row = document.createElement('tr');
          row.innerHTML = `<td>${item}</td><td>${qty} units</td>`;
          table.appendChild(row);
        });
      });

      const date = new Date().toLocaleDateString();
      summaryInfo.innerHTML = `<p><strong>Guest Rooms:</strong> ${rooms} | <strong>Occupancy:</strong> ${occ}% | <strong>PAR:</strong> ${par}</p><p><em>Generated on ${date}</em></p>`;
      resultsDiv.style.display = 'block';
    }

    function exportPDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const logo = "https://raw.githubusercontent.com/campbell3cw/Hospitality-Par-Calculater/main/public/Liberty%20Logo.jpg";
      doc.addImage(logo, 'JPEG', 80, 10, 50, 40);
      let y = 60;
      doc.setFontSize(16);
      doc.text('Liberty Linen - Estimated Linen Requirements', 20, y);
      y += 10;
      doc.setFontSize(11);
      document.querySelectorAll('#summaryInfo p').forEach(p => { doc.text(p.textContent, 20, y); y += 8; });
      y += 5;
      document.querySelectorAll('#resultsTable tr').forEach(tr => {
        const cells = tr.querySelectorAll('th, td');
        if (cells.length === 1) { doc.setFont(undefined, 'bold'); doc.text(cells[0].textContent, 20, y); doc.setFont(undefined, 'normal'); }
        else { doc.text(cells[0].textContent, 25, y); doc.text(cells[1].textContent, 120, y); }
        y += 8;
      });
      doc.setFontSize(10);
      doc.text('*These values are estimates based on your inputs.', 20, y + 10);
      doc.save('Liberty_Linen_PAR_Results.pdf');
    }

    function emailResults() {
      const summary = document.getElementById('summaryInfo').innerText;
      const rows = Array.from(document.querySelectorAll('#resultsTable tr')).map(r => r.innerText).join('%0D%0A');
      window.location.href = `mailto:?subject=Liberty Linen PAR Results&body=${encodeURIComponent(summary + '\n' + rows)}`;
    }

    document.addEventListener('DOMContentLoaded', () => {
      toggleFitted();
      syncPillowcases();
      document.querySelectorAll('input[name="sheetSetup"]').forEach(r => r.addEventListener('change', toggleFitted));
      ['bedKing','bedCalKing','bedQueen','bedFull','bedTwin'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener('input', syncPillowcases);
      });
    });
  </script>
</body>
</html>